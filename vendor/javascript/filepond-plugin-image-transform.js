var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var e={};(function(t,r){e=r()})(0,(function(){var e=function isImage(t){return/^image/.test(t.type)};var r=function getFilenameWithoutExtension(t){return t.substr(0,t.lastIndexOf("."))||t};var a={jpeg:"jpg","svg+xml":"svg"};var n=function renameFileToMatchMimeType(t,e){var n=r(t);var i=e.split("/")[1];var o=a[i]||i;return"".concat(n,".").concat(o)};var i=function getValidOutputMimeType(t){return/jpeg|png|svg\+xml/.test(t)?t:"image/jpeg"};var o=function isImage(t){return/^image/.test(t.type)};var v={1:function _(){return[1,0,0,1,0,0]},2:function _(t){return[-1,0,0,1,t,0]},3:function _(t,e){return[-1,0,0,-1,t,e]},4:function _(t,e){return[1,0,0,-1,0,e]},5:function _(){return[0,1,1,0,0,0]},6:function _(t,e){return[0,1,-1,0,e,0]},7:function _(t,e){return[0,-1,-1,0,e,t]},8:function _(t){return[0,-1,1,0,0,t]}};var u=function getImageOrientationMatrix(t,e,r){-1===r&&(r=1);return v[r](t,e)};var c=function createVector(t,e){return{x:t,y:e}};var l=function vectorDot(t,e){return t.x*e.x+t.y*e.y};var h=function vectorSubtract(t,e){return c(t.x-e.x,t.y-e.y)};var s=function vectorDistanceSquared(t,e){return l(h(t,e),h(t,e))};var f=function vectorDistance(t,e){return Math.sqrt(s(t,e))};var d=function getOffsetPointOnEdge(t,e){var r=t;var a=1.5707963267948966;var n=e;var i=1.5707963267948966-e;var o=Math.sin(a);var v=Math.sin(n);var u=Math.sin(i);var l=Math.cos(i);var h=r/o;var s=h*v;var f=h*u;return c(l*s,l*f)};var g=function getRotatedRectSize(t,e){var r=t.width;var a=t.height;var n=d(r,e);var i=d(a,e);var o=c(t.x+Math.abs(n.x),t.y-Math.abs(n.y));var v=c(t.x+t.width+Math.abs(i.y),t.y+Math.abs(i.x));var u=c(t.x-Math.abs(i.y),t.y+t.height-Math.abs(i.x));return{width:f(o,v),height:f(o,u)}};var y=function getImageRectZoomFactor(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{x:.5,y:.5};var n=a.x>.5?1-a.x:a.x;var i=a.y>.5?1-a.y:a.y;var o=2*n*t.width;var v=2*i*t.height;var u=g(e,r);return Math.max(u.width/o,u.height/v)};var p=function getCenteredCropRect(t,e){var r=t.width;var a=r*e;if(a>t.height){a=t.height;r=a/e}var n=.5*(t.width-r);var i=.5*(t.height-a);return{x:n,y:i,width:r,height:a}};var m=function calculateCanvasSize(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;var a=t.height/t.width;var n=1;var i=e;var o=1;var v=a;if(v>i){v=i;o=v/a}var u=Math.max(n/o,i/v);var c=t.width/(r*u*o);var l=c*e;return{width:c,height:l}};var w=function canvasRelease(t){t.width=1;t.height=1;var e=t.getContext("2d");e.clearRect(0,0,1,1)};var x=function isFlipped(t){return t&&(t.horizontal||t.vertical)};var M=function getBitmap(t,e,r){if(e<=1&&!x(r)){t.width=t.naturalWidth;t.height=t.naturalHeight;return t}var a=document.createElement("canvas");var n=t.naturalWidth;var i=t.naturalHeight;var o=e>=5&&e<=8;if(o){a.width=i;a.height=n}else{a.width=n;a.height=i}var v=a.getContext("2d");e&&v.transform.apply(v,u(n,i,e));if(x(r)){var c=[1,0,0,1,0,0];if(!o&&r.horizontal||o&r.vertical){c[0]=-1;c[4]=n}if(!o&&r.vertical||o&&r.horizontal){c[3]=-1;c[5]=i}v.transform.apply(v,c)}v.drawImage(t,0,0,n,i);return a};var T=function imageToImageData(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var n=a.canvasMemoryLimit,i=a.background,o=void 0===i?null:i;var v=r.zoom||1;var u=M(t,e,r.flip);var c={width:u.width,height:u.height};var l=r.aspectRatio||c.height/c.width;var h=m(c,l,v);if(n){var s=h.width*h.height;if(s>n){var f=Math.sqrt(n)/Math.sqrt(s);c.width=Math.floor(c.width*f);c.height=Math.floor(c.height*f);h=m(c,l,v)}}var d=document.createElement("canvas");var g={x:.5*h.width,y:.5*h.height};var x={x:0,y:0,width:h.width,height:h.height,center:g};var T="undefined"===typeof r.scaleToFit||r.scaleToFit;var b=v*y(c,p(x,l),r.rotation,T?r.center:{x:.5,y:.5});d.width=Math.round(h.width/b);d.height=Math.round(h.height/b);g.x/=b;g.y/=b;var A={x:g.x-c.width*(r.center?r.center.x:.5),y:g.y-c.height*(r.center?r.center.y:.5)};var R=d.getContext("2d");if(o){R.fillStyle=o;R.fillRect(0,0,d.width,d.height)}R.translate(g.x,g.y);R.rotate(r.rotation||0);R.drawImage(u,A.x-g.x,A.y-g.y,c.width,c.height);var I=R.getImageData(0,0,d.width,d.height);w(d);return I};var b=function(){return"undefined"!==typeof window&&"undefined"!==typeof window.document}();b&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function value(t,e,r){var a=this.toDataURL(e,r).split(",")[1];setTimeout((function(){var r=atob(a);var n=r.length;var i=new Uint8Array(n);for(var o=0;o<n;o++)i[o]=r.charCodeAt(o);t(new Blob([i],{type:e||"image/png"}))}))}}));var A=function canvasToBlob(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(a){var n=r?r(t):t;Promise.resolve(n).then((function(t){t.toBlob(a,e.type,e.quality)}))}))};var R=function vectorMultiply(t,e){return k(t.x*e,t.y*e)};var I=function vectorAdd(t,e){return k(t.x+e.x,t.y+e.y)};var E=function vectorNormalize(t){var e=Math.sqrt(t.x*t.x+t.y*t.y);return 0===e?{x:0,y:0}:k(t.x/e,t.y/e)};var O=function vectorRotate(t,e,r){var a=Math.cos(e);var n=Math.sin(e);var i=k(t.x-r.x,t.y-r.y);return k(r.x+a*i.x-n*i.y,r.y+n*i.x+a*i.y)};var k=function createVector(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:t,y:e}};var S=function getMarkupValue(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;var a=arguments.length>3?arguments[3]:void 0;return"string"===typeof t?parseFloat(t)*r:"number"===typeof t?t*(a?e[a]:Math.min(e.width,e.height)):void 0};var L=function getMarkupStyles(t,e,r){var a=t.borderStyle||t.lineStyle||"solid";var n=t.backgroundColor||t.fontColor||"transparent";var i=t.borderColor||t.lineColor||"transparent";var o=S(t.borderWidth||t.lineWidth,e,r);var v=t.lineCap||"round";var u=t.lineJoin||"round";var c="string"===typeof a?"":a.map((function(t){return S(t,e,r)})).join(",");var l=t.opacity||1;return{"stroke-linecap":v,"stroke-linejoin":u,"stroke-width":o||0,"stroke-dasharray":c,stroke:i,fill:n,opacity:l}};var N=function isDefined(t){return null!=t};var C=function getMarkupRect(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;var a=S(t.x,e,r,"width")||S(t.left,e,r,"width");var n=S(t.y,e,r,"height")||S(t.top,e,r,"height");var i=S(t.width,e,r,"width");var o=S(t.height,e,r,"height");var v=S(t.right,e,r,"width");var u=S(t.bottom,e,r,"height");N(n)||(n=N(o)&&N(u)?e.height-o-u:u);N(a)||(a=N(i)&&N(v)?e.width-i-v:v);N(i)||(i=N(a)&&N(v)?e.width-a-v:0);N(o)||(o=N(n)&&N(u)?e.height-n-u:0);return{x:a||0,y:n||0,width:i||0,height:o||0}};var U=function pointsToPathShape(t){return t.map((function(t,e){return"".concat(0===e?"M":"L"," ").concat(t.x," ").concat(t.y)})).join(" ")};var B=function setAttributes(t,e){return Object.keys(e).forEach((function(r){return t.setAttribute(r,e[r])}))};var F="http://www.w3.org/2000/svg";var P=function svg(t,e){var r=document.createElementNS(F,t);e&&B(r,e);return r};var G=function updateRect(t){return B(t,Object.assign({},t.rect,t.styles))};var z=function updateEllipse(t){var e=t.rect.x+.5*t.rect.width;var r=t.rect.y+.5*t.rect.height;var a=.5*t.rect.width;var n=.5*t.rect.height;return B(t,Object.assign({cx:e,cy:r,rx:a,ry:n},t.styles))};var j={contain:"xMidYMid meet",cover:"xMidYMid slice"};var D=function updateImage(t,e){B(t,Object.assign({},t.rect,t.styles,{preserveAspectRatio:j[e.fit]||"none"}))};var q={left:"start",center:"middle",right:"end"};var V=function updateText(t,e,r,a){var n=S(e.fontSize,r,a);var i=e.fontFamily||"sans-serif";var o=e.fontWeight||"normal";var v=q[e.textAlign]||"start";B(t,Object.assign({},t.rect,t.styles,{"stroke-width":0,"font-weight":o,"font-size":n,"font-family":i,"text-anchor":v}));if(t.text!==e.text){t.text=e.text;t.textContent=e.text.length?e.text:" "}};var H=function updateLine(t,e,r,a){B(t,Object.assign({},t.rect,t.styles,{fill:"none"}));var n=t.childNodes[0];var i=t.childNodes[1];var o=t.childNodes[2];var v=t.rect;var u={x:t.rect.x+t.rect.width,y:t.rect.y+t.rect.height};B(n,{x1:v.x,y1:v.y,x2:u.x,y2:u.y});if(e.lineDecoration){i.style.display="none";o.style.display="none";var c=E({x:u.x-v.x,y:u.y-v.y});var l=S(.05,r,a);if(-1!==e.lineDecoration.indexOf("arrow-begin")){var h=R(c,l);var s=I(v,h);var f=O(v,2,s);var d=O(v,-2,s);B(i,{style:"display:block;",d:"M".concat(f.x,",").concat(f.y," L").concat(v.x,",").concat(v.y," L").concat(d.x,",").concat(d.y)})}if(-1!==e.lineDecoration.indexOf("arrow-end")){var g=R(c,-l);var y=I(u,g);var p=O(u,2,y);var m=O(u,-2,y);B(o,{style:"display:block;",d:"M".concat(p.x,",").concat(p.y," L").concat(u.x,",").concat(u.y," L").concat(m.x,",").concat(m.y)})}}};var W=function updatePath(t,e,r,a){B(t,Object.assign({},t.styles,{fill:"none",d:U(e.points.map((function(t){return{x:S(t.x,r,a,"width"),y:S(t.y,r,a,"height")}})))}))};var Y=function createShape(t){return function(e){return P(t,{id:e.id})}};var Q=function createImage(t){var e=P("image",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});e.onload=function(){e.setAttribute("opacity",t.opacity||1)};e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.src);return e};var J=function createLine(t){var e=P("g",{id:t.id,"stroke-linecap":"round","stroke-linejoin":"round"});var r=P("line");e.appendChild(r);var a=P("path");e.appendChild(a);var n=P("path");e.appendChild(n);return e};var K={image:Q,rect:Y("rect"),ellipse:Y("ellipse"),text:Y("text"),path:Y("path"),line:J};var Z={rect:G,ellipse:z,image:D,text:V,path:W,line:H};var $=function createMarkupByType(t,e){return K[t](e)};var X=function updateMarkupByType(t,e,r,a,n){"path"!==e&&(t.rect=C(r,a,n));t.styles=L(r,a,n);Z[e](t,r,a,n)};var tt=function sortMarkupByZIndex(t,e){return t[1].zIndex>e[1].zIndex?1:t[1].zIndex<e[1].zIndex?-1:0};var et=function cropSVG(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r=arguments.length>2?arguments[2]:void 0;var a=arguments.length>3?arguments[3]:void 0;return new Promise((function(n){var i=a.background,o=void 0===i?null:i;var v=new FileReader;v.onloadend=function(){var t=v.result;var a=document.createElement("div");a.style.cssText="position:absolute;pointer-events:none;width:0;height:0;visibility:hidden;";a.innerHTML=t;var i=a.querySelector("svg");document.body.appendChild(a);var u=i.getBBox();a.parentNode.removeChild(a);var c=a.querySelector("title");var l=i.getAttribute("viewBox")||"";var h=i.getAttribute("width")||"";var s=i.getAttribute("height")||"";var f=parseFloat(h)||null;var d=parseFloat(s)||null;var g=(h.match(/[a-z]+/)||[])[0]||"";var m=(s.match(/[a-z]+/)||[])[0]||"";var w=l.split(" ").map(parseFloat);var x=w.length?{x:w[0],y:w[1],width:w[2],height:w[3]}:u;var M=null!=f?f:x.width;var T=null!=d?d:x.height;i.style.overflow="visible";i.setAttribute("width",M);i.setAttribute("height",T);var b="";if(r&&r.length){var A={width:M,height:T};b=r.sort(tt).reduce((function(t,e){var r=$(e[0],e[1]);X(r,e[0],e[1],A);r.removeAttribute("id");1===r.getAttribute("opacity")&&r.removeAttribute("opacity");return t+"\n"+r.outerHTML+"\n"}),"");b="\n\n<g>".concat(b.replace(/&nbsp;/g," "),"</g>\n\n")}var R=e.aspectRatio||T/M;var I=M;var E=I*R;var O="undefined"===typeof e.scaleToFit||e.scaleToFit;var k=e.center?e.center.x:.5;var S=e.center?e.center.y:.5;var L=y({width:M,height:T},p({width:I,height:E},R),e.rotation,O?{x:k,y:S}:{x:.5,y:.5});var N=e.zoom*L;var C=e.rotation*(180/Math.PI);var U={x:.5*I,y:.5*E};var B={x:U.x-M*k,y:U.y-T*S};var F=["rotate(".concat(C," ").concat(U.x," ").concat(U.y,")"),"translate(".concat(U.x," ").concat(U.y,")"),"scale(".concat(N,")"),"translate(".concat(-U.x," ").concat(-U.y,")"),"translate(".concat(B.x," ").concat(B.y,")")];var P=e.flip&&e.flip.horizontal;var G=e.flip&&e.flip.vertical;var z=["scale(".concat(P?-1:1," ").concat(G?-1:1,")"),"translate(".concat(P?-M:0," ").concat(G?-T:0,")")];var j='<?xml version="1.0" encoding="UTF-8"?>\n<svg width="'.concat(I).concat(g,'" height="').concat(E).concat(m,'" \nviewBox="0 0 ').concat(I," ").concat(E,'" ').concat(o?'style="background:'+o+'" ':"",'\npreserveAspectRatio="xMinYMin"\nxmlns:xlink="http://www.w3.org/1999/xlink"\nxmlns="http://www.w3.org/2000/svg">\n\x3c!-- Generated by PQINA - https://pqina.nl/ --\x3e\n<title>').concat(c?c.textContent:"",'</title>\n<g transform="').concat(F.join(" "),'">\n<g transform="').concat(z.join(" "),'">\n').concat(i.outerHTML).concat(b,"\n</g>\n</g>\n</svg>");n(j)};v.readAsText(t)}))};var rt=function objectToImageData(t){var e;try{e=new ImageData(t.width,t.height)}catch(a){var r=document.createElement("canvas");e=r.getContext("2d").createImageData(t.width,t.height)}e.data.set(t.data);return e};var at=function TransformWorker(){var t={resize:resize,filter:filter};var e=function applyTransforms(e,r){e.forEach((function(e){r=t[e.type](r,e.data)}));return r};var r=function transform(t,r){var a=t.transforms;var n=null;a.forEach((function(t){"filter"===t.type&&(n=t)}));if(n){var i=null;a.forEach((function(t){"resize"===t.type&&(i=t)}));if(i){i.data.matrix=n.data;a=a.filter((function(t){return"filter"!==t.type}))}}r(e(a,t.imageData))};self.onmessage=function(t){r(t.data.message,(function(e){self.postMessage({id:t.data.id,message:e},[e.data.buffer])}))};var a=1;var n=1;var i=1;function applyFilterMatrix(t,e,r){var o=e[t]/255;var v=e[t+1]/255;var u=e[t+2]/255;var c=e[t+3]/255;var l=o*r[0]+v*r[1]+u*r[2]+c*r[3]+r[4];var h=o*r[5]+v*r[6]+u*r[7]+c*r[8]+r[9];var s=o*r[10]+v*r[11]+u*r[12]+c*r[13]+r[14];var f=o*r[15]+v*r[16]+u*r[17]+c*r[18]+r[19];var d=Math.max(0,l*f)+a*(1-f);var g=Math.max(0,h*f)+n*(1-f);var y=Math.max(0,s*f)+i*(1-f);e[t]=255*Math.max(0,Math.min(1,d));e[t+1]=255*Math.max(0,Math.min(1,g));e[t+2]=255*Math.max(0,Math.min(1,y))}var o=self.JSON.stringify([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]);function isIdentityMatrix(t){return self.JSON.stringify(t||[])===o}function filter(t,e){if(!e||isIdentityMatrix(e))return t;var r=t.data;var o=r.length;var v=e[0];var u=e[1];var c=e[2];var l=e[3];var h=e[4];var s=e[5];var f=e[6];var d=e[7];var g=e[8];var y=e[9];var p=e[10];var m=e[11];var w=e[12];var x=e[13];var M=e[14];var T=e[15];var b=e[16];var A=e[17];var R=e[18];var I=e[19];var E=0,O=0,k=0,S=0,L=0,N=0,C=0,U=0,B=0,F=0,P=0,G=0;for(;E<o;E+=4){O=r[E]/255;k=r[E+1]/255;S=r[E+2]/255;L=r[E+3]/255;N=O*v+k*u+S*c+L*l+h;C=O*s+k*f+S*d+L*g+y;U=O*p+k*m+S*w+L*x+M;B=O*T+k*b+S*A+L*R+I;F=Math.max(0,N*B)+a*(1-B);P=Math.max(0,C*B)+n*(1-B);G=Math.max(0,U*B)+i*(1-B);r[E]=255*Math.max(0,Math.min(1,F));r[E+1]=255*Math.max(0,Math.min(1,P));r[E+2]=255*Math.max(0,Math.min(1,G))}return t}function resize(t,e){var r=e.mode,a=void 0===r?"contain":r,n=e.upscale,i=void 0!==n&&n,o=e.width,v=e.height,u=e.matrix;u=!u||isIdentityMatrix(u)?null:u;if(!o&&!v)return filter(t,u);null===o?o=v:null===v&&(v=o);if("force"!==a){var c=o/t.width;var l=v/t.height;var h=1;"cover"===a?h=Math.max(c,l):"contain"===a&&(h=Math.min(c,l));if(h>1&&false===i)return filter(t,u);o=t.width*h;v=t.height*h}var s=t.width;var f=t.height;var d=Math.round(o);var g=Math.round(v);var y=t.data;var p=new Uint8ClampedArray(d*g*4);var m=s/d;var w=f/g;var x=Math.ceil(.5*m);var M=Math.ceil(.5*w);for(var T=0;T<g;T++)for(var b=0;b<d;b++){var A=4*(b+T*d);var R=0;var I=0;var E=0;var O=0;var k=0;var S=0;var L=0;var N=(T+.5)*w;for(var C=Math.floor(T*w);C<(T+1)*w;C++){var U=Math.abs(N-(C+.5))/M;var B=(b+.5)*m;var F=U*U;for(var P=Math.floor(b*m);P<(b+1)*m;P++){var G=Math.abs(B-(P+.5))/x;var z=Math.sqrt(F+G*G);if(z>=-1&&z<=1){R=2*z*z*z-3*z*z+1;if(R>0){G=4*(P+C*s);var j=y[G+3];L+=R*j;E+=R;j<255&&(R=R*j/250);O+=R*y[G];k+=R*y[G+1];S+=R*y[G+2];I+=R}}}}p[A]=O/I;p[A+1]=k/I;p[A+2]=S/I;p[A+3]=L/E;u&&applyFilterMatrix(A,p,u)}return{data:p,width:d,height:g}}};var nt=function correctOrientation(t,e){if(1165519206===t.getUint32(e+4,false)){e+=4;var r=18761===t.getUint16(e+=6,false);e+=t.getUint32(e+4,r);var a=t.getUint16(e,r);e+=2;for(var n=0;n<a;n++)if(274===t.getUint16(e+12*n,r)){t.setUint16(e+12*n+8,1,r);return true}return false}};var it=function readData(t){var e=new DataView(t);if(65496!==e.getUint16(0))return null;var r=2;var a;var n;var i=false;while(r<e.byteLength){a=e.getUint16(r,false);n=e.getUint16(r+2,false)+2;var o=a>=65504&&a<=65519||65534===a;if(!o)break;i||(i=nt(e,r,n));if(r+n>e.byteLength)break;r+=n}return t.slice(0,r)};var ot=function getImageHead(t){return new Promise((function(e){var r=new FileReader;r.onload=function(){return e(it(r.result)||null)};r.readAsArrayBuffer(t.slice(0,262144))}))};var vt=function getBlobBuilder(){return window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder};var ut=function createBlob(t,e){var r=vt();if(r){var a=new r;a.append(t);return a.getBlob(e)}return new Blob([t],{type:e})};var ct=function getUniqueId(){return Math.random().toString(36).substr(2,9)};var lt=function createWorker(t){var e=new Blob(["(",t.toString(),")()"],{type:"application/javascript"});var r=URL.createObjectURL(e);var a=new Worker(r);var n=[];return{transfer:function transfer(){},post:function post(t,e,r){var i=ct();n[i]=e;a.onmessage=function(t){var e=n[t.data.id];if(e){e(t.data.message);delete n[t.data.id]}};a.postMessage({id:i,message:t},r)},terminate:function terminate(){a.terminate();URL.revokeObjectURL(r)}}};var ht=function loadImage(t){return new Promise((function(e,r){var a=new Image;a.onload=function(){e(a)};a.onerror=function(t){r(t)};a.src=t}))};var st=function chain(t){return t.reduce((function(t,e){return t.then((function(t){return e().then(Array.prototype.concat.bind(t))}))}),Promise.resolve([]))};var ft=function canvasApplyMarkup(t,e){return new Promise((function(r){var a={width:t.width,height:t.height};var n=t.getContext("2d");var i=e.sort(tt).map((function(t){return function(){return new Promise((function(e){var r=Tt[t[0]](n,a,t[1],e);r&&e()}))}}));st(i).then((function(){return r(t)}))}))};var dt=function applyMarkupStyles(t,e){t.beginPath();t.lineCap=e["stroke-linecap"];t.lineJoin=e["stroke-linejoin"];t.lineWidth=e["stroke-width"];e["stroke-dasharray"].length&&t.setLineDash(e["stroke-dasharray"].split(","));t.fillStyle=e.fill;t.strokeStyle=e.stroke;t.globalAlpha=e.opacity||1};var gt=function drawMarkupStyles(t){t.fill();t.stroke();t.globalAlpha=1};var yt=function drawRect(t,e,r){var a=C(r,e);var n=L(r,e);dt(t,n);t.rect(a.x,a.y,a.width,a.height);gt(t,n);return true};var pt=function drawEllipse(t,e,r){var a=C(r,e);var n=L(r,e);dt(t,n);var i=a.x,o=a.y,v=a.width,u=a.height,c=.5522848,l=v/2*c,h=u/2*c,s=i+v,f=o+u,d=i+v/2,g=o+u/2;t.moveTo(i,g);t.bezierCurveTo(i,g-h,d-l,o,d,o);t.bezierCurveTo(d+l,o,s,g-h,s,g);t.bezierCurveTo(s,g+h,d+l,f,d,f);t.bezierCurveTo(d-l,f,i,g+h,i,g);gt(t,n);return true};var mt=function drawImage(t,e,r,a){var n=C(r,e);var i=L(r,e);dt(t,i);var o=new Image;var v=new URL(r.src,window.location.href).origin!==window.location.origin;v&&(o.crossOrigin="");o.onload=function(){if("cover"===r.fit){var e=n.width/n.height;var v=e>1?o.width:o.height*e;var u=e>1?o.width/e:o.height;var c=.5*o.width-.5*v;var l=.5*o.height-.5*u;t.drawImage(o,c,l,v,u,n.x,n.y,n.width,n.height)}else if("contain"===r.fit){var h=Math.min(n.width/o.width,n.height/o.height);var s=h*o.width;var f=h*o.height;var d=n.x+.5*n.width-.5*s;var g=n.y+.5*n.height-.5*f;t.drawImage(o,0,0,o.width,o.height,d,g,s,f)}else t.drawImage(o,0,0,o.width,o.height,n.x,n.y,n.width,n.height);gt(t,i);a()};o.src=r.src};var wt=function drawText(t,e,r){var a=C(r,e);var n=L(r,e);dt(t,n);var i=S(r.fontSize,e);var o=r.fontFamily||"sans-serif";var v=r.fontWeight||"normal";var u=r.textAlign||"left";t.font="".concat(v," ").concat(i,"px ").concat(o);t.textAlign=u;t.fillText(r.text,a.x,a.y);gt(t,n);return true};var xt=function drawPath(t,e,r){var a=L(r,e);dt(t,a);t.beginPath();var n=r.points.map((function(t){return{x:S(t.x,e,1,"width"),y:S(t.y,e,1,"height")}}));t.moveTo(n[0].x,n[0].y);var i=n.length;for(var o=1;o<i;o++)t.lineTo(n[o].x,n[o].y);gt(t,a);return true};var Mt=function drawLine(t,e,r){var a=C(r,e);var n=L(r,e);dt(t,n);t.beginPath();var i={x:a.x,y:a.y};var o={x:a.x+a.width,y:a.y+a.height};t.moveTo(i.x,i.y);t.lineTo(o.x,o.y);var v=E({x:o.x-i.x,y:o.y-i.y});var u=.04*Math.min(e.width,e.height);if(-1!==r.lineDecoration.indexOf("arrow-begin")){var c=R(v,u);var l=I(i,c);var h=O(i,2,l);var s=O(i,-2,l);t.moveTo(h.x,h.y);t.lineTo(i.x,i.y);t.lineTo(s.x,s.y)}if(-1!==r.lineDecoration.indexOf("arrow-end")){var f=R(v,-u);var d=I(o,f);var g=O(o,2,d);var y=O(o,-2,d);t.moveTo(g.x,g.y);t.lineTo(o.x,o.y);t.lineTo(y.x,y.y)}gt(t,n);return true};var Tt={rect:yt,ellipse:pt,image:mt,text:wt,line:Mt,path:xt};var bt=function imageDataToCanvas(t){var e=document.createElement("canvas");e.width=t.width;e.height=t.height;var r=e.getContext("2d");r.putImageData(t,0,0);return e};var At=function transformImage(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(a,n){if(!t||!o(t))return n({status:"not an image file",file:t});var i=r.stripImageHead,v=r.beforeCreateBlob,u=r.afterCreateBlob,c=r.canvasMemoryLimit;var l=e.crop,h=e.size,s=e.filter,f=e.markup,d=e.output;var g=e.image&&e.image.orientation?Math.max(1,Math.min(8,e.image.orientation)):null;var y=d&&d.quality;var p=null===y?null:y/100;var m=d&&d.type||null;var x=d&&d.background||null;var M=[];!h||"number"!==typeof h.width&&"number"!==typeof h.height||M.push({type:"resize",data:h});s&&20===s.length&&M.push({type:"filter",data:s});var b=function resolveWithBlob(t){var e=u?u(t):t;Promise.resolve(e).then(a)};var R=function toBlob(e,r){var a=bt(e);var o=f.length?ft(a,f):a;Promise.resolve(o).then((function(e){A(e,r,v).then((function(r){w(e);if(i)return b(r);ot(t).then((function(t){null!==t&&(r=new Blob([t,r.slice(20)],{type:r.type}));b(r)}))})).catch(n)}))};if(/svg/.test(t.type)&&null===m)return et(t,l,f,{background:x}).then((function(t){a(ut(t,"image/svg+xml"))}));var I=URL.createObjectURL(t);ht(I).then((function(e){URL.revokeObjectURL(I);var r=T(e,g,l,{canvasMemoryLimit:c,background:x});var a={quality:p,type:m||t.type};if(!M.length)return R(r,a);var n=lt(at);n.post({transforms:M,imageData:r},(function(t){R(rt(t),a);n.terminate()}),[r.data.buffer])})).catch(n)}))};function _AwaitValue(e){(this||t).wrapped=e}function _AsyncGenerator(e){var r,a;function send(t,e){return new Promise((function(n,i){var o={key:t,arg:e,resolve:n,reject:i,next:null};if(a)a=a.next=o;else{r=a=o;resume(t,e)}}))}function resume(t,r){try{var a=e[t](r);var n=a.value;var i=n instanceof _AwaitValue;Promise.resolve(i?n.wrapped:n).then((function(t){i?resume("next",t):settle(a.done?"return":"normal",t)}),(function(t){resume("throw",t)}))}catch(t){settle("throw",t)}}function settle(t,e){switch(t){case"return":r.resolve({value:e,done:true});break;case"throw":r.reject(e);break;default:r.resolve({value:e,done:false});break}r=r.next;r?resume(r.key,r.arg):a=null}(this||t)._invoke=send;"function"!==typeof e.return&&((this||t).return=void 0)}"function"===typeof Symbol&&Symbol.asyncIterator&&(_AsyncGenerator.prototype[Symbol.asyncIterator]=function(){return this||t});_AsyncGenerator.prototype.next=function(t){return this._invoke("next",t)};_AsyncGenerator.prototype.throw=function(t){return this._invoke("throw",t)};_AsyncGenerator.prototype.return=function(t){return this._invoke("return",t)};function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArrayLimit(t,e){var r=[];var a=true;var n=false;var i=void 0;try{for(var o,v=t[Symbol.iterator]();!(a=(o=v.next()).done);a=true){r.push(o.value);if(e&&r.length===e)break}}catch(t){n=true;i=t}finally{try{a||null==v.return||v.return()}finally{if(n)throw i}}return r}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var _t=["x","y","left","top","right","bottom","width","height"];var Rt=function toOptionalFraction(t){return"string"===typeof t&&/%/.test(t)?parseFloat(t)/100:t};var It=function prepareMarkup(t){var e=_slicedToArray(t,2),r=e[0],a=e[1];var n=a.points?{}:_t.reduce((function(t,e){t[e]=Rt(a[e]);return t}),{});return[r,Object.assign({zIndex:0},a,n)]};var Et=function getImageSize(t){return new Promise((function(e,r){var a=new Image;a.src=URL.createObjectURL(t);var n=function measure(){var t=a.naturalWidth;var r=a.naturalHeight;var n=t&&r;if(n){URL.revokeObjectURL(a.src);clearInterval(i);e({width:t,height:r})}};a.onerror=function(t){URL.revokeObjectURL(a.src);clearInterval(i);r(t)};var i=setInterval(n,1);n()}))};"undefined"!==typeof window&&"undefined"!==typeof window.document&&(HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function value(e,r,a){var n=this||t;setTimeout((function(){var t=n.toDataURL(r,a).split(",")[1];var i=atob(t);var o=i.length;var v=new Uint8Array(o);while(o--)v[o]=i.charCodeAt(o);e(new Blob([v],{type:r||"image/png"}))}))}}));var Ot="undefined"!==typeof window&&"undefined"!==typeof window.document;var kt=Ot&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;var St=function plugin(t){var r=t.addFilter,a=t.utils;var o=a.Type,v=a.forin,u=a.getFileFromBlob,c=a.isFile;var l=["crop","resize","filter","markup","output"];var h=function createVariantCreator(t){return function(e,r,a){return e(r,t?t(a):a)}};var s=function isDefaultCrop(t){return null===t.aspectRatio&&0===t.rotation&&1===t.zoom&&t.center&&.5===t.center.x&&.5===t.center.y&&t.flip&&false===t.flip.horizontal&&false===t.flip.vertical};r("SHOULD_PREPARE_OUTPUT",(function(t,e){var r=e.query;return new Promise((function(t){t(!r("IS_ASYNC"))}))}));var f=function shouldTransformFile(t,r,a){return new Promise((function(n){if(!t("GET_ALLOW_IMAGE_TRANSFORM")||a.archived||!c(r)||!e(r))return n(false);Et(r).then((function(){var e=t("GET_IMAGE_TRANSFORM_IMAGE_FILTER");if(e){var a=e(r);if(null==a)return handleRevert(true);if("boolean"===typeof a)return n(a);if("function"===typeof a.then)return a.then(n)}n(true)})).catch((function(t){n(false)}))}))};r("DID_CREATE_ITEM",(function(t,e){var r=e.query,a=e.dispatch;r("GET_ALLOW_IMAGE_TRANSFORM")&&t.extend("requestPrepare",(function(){return new Promise((function(e,r){a("REQUEST_PREPARE_OUTPUT",{query:t.id,item:t,success:e,failure:r},true)}))}))}));r("PREPARE_OUTPUT",(function(t,e){var r=e.query,a=e.item;return new Promise((function(e){f(r,t,a).then((function(o){if(!o)return e(t);var c=[];r("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_ORIGINAL")&&c.push((function(){return new Promise((function(e){e({name:r("GET_IMAGE_TRANSFORM_VARIANTS_ORIGINAL_NAME"),file:t})}))}));r("GET_IMAGE_TRANSFORM_VARIANTS_INCLUDE_DEFAULT")&&c.push((function(t,e,a){return new Promise((function(n){t(e,a).then((function(t){return n({name:r("GET_IMAGE_TRANSFORM_VARIANTS_DEFAULT_NAME"),file:t})}))}))}));var f=r("GET_IMAGE_TRANSFORM_VARIANTS")||{};v(f,(function(t,e){var r=h(e);c.push((function(e,a,n){return new Promise((function(i){r(e,a,n).then((function(e){return i({name:t,file:e})}))}))}))}));var d=r("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY");var g=r("GET_IMAGE_TRANSFORM_OUTPUT_QUALITY_MODE");var y=null===d?null:d/100;var p=r("GET_IMAGE_TRANSFORM_OUTPUT_MIME_TYPE");var m=r("GET_IMAGE_TRANSFORM_CLIENT_TRANSFORMS")||l;a.setMetadata("output",{type:p,quality:y,client:m},true);var w=function transform(t,e){return new Promise((function(a,o){var v=Object.assign({},e);Object.keys(v).filter((function(t){return"exif"!==t})).forEach((function(t){-1===m.indexOf(t)&&delete v[t]}));var c=v.resize,l=v.exif,h=v.output,f=v.crop,d=v.filter,y=v.markup;var p={image:{orientation:l?l.orientation:null},output:h&&(h.type||"number"===typeof h.quality||h.background)?{type:h.type,quality:"number"===typeof h.quality?100*h.quality:null,background:h.background||r("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR")||null}:void 0,size:c&&(c.size.width||c.size.height)?Object.assign({mode:c.mode,upscale:c.upscale},c.size):void 0,crop:f&&!s(f)?Object.assign({},f):void 0,markup:y&&y.length?y.map(It):[],filter:d};if(p.output){var w=!!h.type&&h.type!==t.type;var x=/\/jpe?g$/.test(t.type);var M=null!==h.quality&&(x&&"always"===g);var T=!!(p.size||p.crop||p.filter||w||M);if(!T)return a(t)}var b={beforeCreateBlob:r("GET_IMAGE_TRANSFORM_BEFORE_CREATE_BLOB"),afterCreateBlob:r("GET_IMAGE_TRANSFORM_AFTER_CREATE_BLOB"),canvasMemoryLimit:r("GET_IMAGE_TRANSFORM_CANVAS_MEMORY_LIMIT"),stripImageHead:r("GET_IMAGE_TRANSFORM_OUTPUT_STRIP_IMAGE_HEAD")};At(t,p,b).then((function(e){var r=u(e,n(t.name,i(e.type)));a(r)})).catch(o)}))};var x=c.map((function(e){return e(w,t,a.getMetadata())}));Promise.all(x).then((function(t){e(1===t.length&&null===t[0].name?t[0].file:t)}))}))}))}));return{options:{allowImageTransform:[true,o.BOOLEAN],imageTransformImageFilter:[null,o.FUNCTION],imageTransformOutputMimeType:[null,o.STRING],imageTransformOutputQuality:[null,o.INT],imageTransformOutputStripImageHead:[true,o.BOOLEAN],imageTransformClientTransforms:[null,o.ARRAY],imageTransformOutputQualityMode:["always",o.STRING],imageTransformVariants:[null,o.OBJECT],imageTransformVariantsIncludeDefault:[true,o.BOOLEAN],imageTransformVariantsDefaultName:[null,o.STRING],imageTransformVariantsIncludeOriginal:[false,o.BOOLEAN],imageTransformVariantsOriginalName:["original_",o.STRING],imageTransformBeforeCreateBlob:[null,o.FUNCTION],imageTransformAfterCreateBlob:[null,o.FUNCTION],imageTransformCanvasMemoryLimit:[Ot&&kt?16777216:null,o.INT],imageTransformCanvasBackgroundColor:[null,o.STRING]}}};Ot&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:St}));return St}));var r=e;export default r;

